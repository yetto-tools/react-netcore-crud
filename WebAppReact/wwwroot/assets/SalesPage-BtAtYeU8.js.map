{"version":3,"file":"SalesPage-BtAtYeU8.js","sources":["../../front-react/src/stores/useSalesStore.jsx","../../front-react/src/pages/SalesPage.jsx"],"sourcesContent":["import { create } from \"zustand\";\r\n\r\n// Define el store\r\nconst useSalesStore = create((set) => ({\r\n  sales: [],\r\n  setInvoices: (newSales) => set({ sales: newSales }),\r\n}));\r\n\r\nexport default useSalesStore;\r\n","import { useTranslation } from \"react-i18next\";\r\nimport LayoutDefault from \"../layouts/LayoutDefault\";\r\nimport useSalesStore from \"../stores/useSalesStore\";\r\nimport useFetchDataStore from \"../stores/useFetchDataStore\";\r\nimport { useCallback, useEffect, useState } from \"react\";\r\nimport { API } from \"../stores/API/Endpoints\";\r\nimport { TypeFormProduct, setTypeFormProduct } from \"../types/TypesForm\";\r\nimport useAuthStore from \"../stores/useAuthStore\";\r\nimport Modal from \"../components/controls/Modal\";\r\nimport ProductForm from \"../components/forms/ProductForm\";\r\nimport SearchInput from \"../components/controls/SeachInput\";\r\nimport { Link } from \"react-router-dom\";\r\nimport {\r\n  IconChevronRight,\r\n  IconNew,\r\n  IconRefresh,\r\n  IconSearch,\r\n} from \"../icons/Icon\";\r\nimport useLoading from \"../stores/useLoading\";\r\nimport APIFetchData from \"../stores/useFetchDataStore\";\r\n\r\nconst SalesPage = () => {\r\n  const { t } = useTranslation();\r\n  const [formValues, setFormValue] = useState(TypeFormProduct);\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [pageSales, setPageSales] = useState(1);\r\n  const [sizePages, setSizePages] = useState(25);\r\n  const [isModalOpen, setModalOpen] = useState(false);\r\n\r\n  const { auth } = useAuthStore((state) => ({\r\n    auth: state.auth,\r\n  }));\r\n\r\n  const { isLoading, setIsLoading } = useLoading((state) => ({\r\n    isLoading: state.isLoading,\r\n    setIsLoading: state.setIsLoading,\r\n  }));\r\n\r\n  const { sales, setSales } = useSalesStore((state) => ({\r\n    sales: state.sales,\r\n    setSales: state.setSales,\r\n  }));\r\n\r\n  useEffect(() => {\r\n    setFormValue((prev) => ({\r\n      ...prev,\r\n      uid_creacion: auth.userData.id_usuario,\r\n    }));\r\n\r\n    if (Object.values(sales).length == 0 && isLoading == false) {\r\n      handleRefreshSales();\r\n    }\r\n  }, []);\r\n\r\n  const handleRefreshSales = useCallback(async () => {\r\n    await APIFetchData({\r\n      setStore: setSales,\r\n      url: `${API.sale.sales.url}?page_size=25&page_number=${pageSales}`,\r\n      method: API.sale.sales.method,\r\n      setIsLoading: setIsLoading,\r\n    });\r\n  }, [APIFetchData, pageSales]);\r\n\r\n  const handleChange = (event) => {\r\n    const { name, value, type, checked } = event.target;\r\n    const inputValue = type === \"checkbox\" ? (checked ? 1 : 0) : value;\r\n\r\n    setFormValue((prev) => ({\r\n      ...prev,\r\n      [name]: inputValue,\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n    console.log(formValues);\r\n    await APIFetchData({\r\n      setStore: setSales,\r\n      url: API.product.save.url,\r\n      method: API.product.save.method,\r\n      body: formValues,\r\n      setIsLoading: setIsLoading,\r\n    });\r\n    if (sales?.data?.response) {\r\n      console.log(sales?.data?.response);\r\n      //closeModal();\r\n    }\r\n  };\r\n\r\n  const openModal = () => setModalOpen(true);\r\n  const closeModal = () => {\r\n    setFormValue(TypeFormProduct);\r\n    setModalOpen(false);\r\n  };\r\n\r\n  const handleSearchSales = async () => {\r\n    if (searchValue.trim().length > 0) {\r\n      await APIFetchData({\r\n        setStore: setSales,\r\n        url: `${API.sale.sales.url}?value=${searchValue}`,\r\n        method: API.sale.sales.method,\r\n        setIsLoading: setIsLoading,\r\n      });\r\n    } else {\r\n      await APIFetchData({\r\n        setStore: setSales,\r\n        url: `${API.sale.sales.url}?page_size=25&page_number=${pageSales}`,\r\n        method: API.sale.sales.method,\r\n        setIsLoading: setIsLoading,\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleUpdate = (event) => {\r\n    const id = event.currentTarget.value;\r\n    const edit = sales?.data?.content.find(\r\n      (item) => item.id_sales === Number(id)\r\n    );\r\n    const newValue = setTypeFormProduct(edit);\r\n    setFormValue(newValue);\r\n    openModal();\r\n  };\r\n\r\n  return (\r\n    <LayoutDefault>\r\n      <div className=\"flex-1 w-full\">\r\n        <section className=\"bg-white px-4 pt-4 inline-flex justify-between items-center w-full border-b mb-4 \">\r\n          <h1 className=\"text-2xl font-semibold mb-1 pr-4 inline-flex items-center gap-2\">\r\n            <Link to=\"/\"> {t(\"home.title\")}</Link>\r\n            <IconChevronRight />\r\n            <span>{t(\"sales.title\")}</span>\r\n          </h1>\r\n          <span>\r\n            <button\r\n              className=\"bg-orange-400 text-white p-1 shadow hover:scale-95\"\r\n              value={\"refresh\"}\r\n              onClick={handleSearchSales}\r\n            >\r\n              {/* Icon for refresh */}\r\n              <IconRefresh />\r\n            </button>\r\n          </span>\r\n        </section>\r\n        <section className=\"w-full bg-white divide-y border-b pb-4 mb-2.5\">\r\n          <section className=\"w-full px-5 mx-auto flex justify-between items-center\">\r\n            <div className=\"w-44\">\r\n              <button\r\n                className={`inline-flex gap-4 max-w-32 rounded-sm w-full min-w-20 outline-green-400 px-2.5 py-1.5 text-white font-semibold relative overflow-hidden capitalize group ${\r\n                  !isLoading\r\n                    ? \"bg-green-600 active:scale-95 shadow\"\r\n                    : \"bg-green-600/50\"\r\n                }`}\r\n                onClick={openModal}\r\n                type=\"submit\"\r\n                disabled={isLoading}\r\n              >\r\n                <IconNew />\r\n                {t(\"categories.new\")}\r\n                <div\r\n                  className={`absolute top-0 -inset-full h-full w-1/2 z-5 block transform -skew-x-12 bg-gradient-to-r from-transparent to-white opacity-40 ${\r\n                    isLoading\r\n                      ? \"animate-shineInfinity\"\r\n                      : \"group-hover:animate-shine\"\r\n                  } `}\r\n                />\r\n              </button>\r\n            </div>\r\n            <div className=\"inline-flex\">\r\n              <SearchInput\r\n                searchValue={searchValue}\r\n                setSearchValue={setSearchValue}\r\n              />\r\n              <button\r\n                className={`max-w-24 outline-sky-400 px-2.5 py-1.5 text-white font-semibold relative overflow-hidden group ${\r\n                  !isLoading\r\n                    ? \"bg-sky-600 active:scale-95 shadow\"\r\n                    : \"bg-sky-600/50\"\r\n                }`}\r\n                onClick={handleRefreshSales}\r\n                type=\"button\"\r\n                disabled={isLoading}\r\n              >\r\n                <IconSearch />\r\n                <div\r\n                  className={`absolute top-0 -inset-full h-full w-1/2 z-5 block transform -skew-x-12 bg-gradient-to-r from-transparent to-white opacity-40 ${\r\n                    isLoading\r\n                      ? \"animate-shineInfinity\"\r\n                      : \"group-hover:animate-shine\"\r\n                  } `}\r\n                />\r\n              </button>\r\n            </div>\r\n          </section>\r\n        </section>\r\n        {/* Modal and forms */}\r\n        <Modal isOpen={isModalOpen} onClose={closeModal}>\r\n          <ProductForm\r\n            isLoading={isLoading}\r\n            formValues={formValues}\r\n            setFormValue={setFormValue}\r\n            handleChange={handleChange}\r\n            handleSubmit={handleSubmit}\r\n          />\r\n        </Modal>\r\n      </div>\r\n    </LayoutDefault>\r\n  );\r\n};\r\n\r\nexport default SalesPage;\r\n"],"names":["useSalesStore","create","set","newSales","SalesPage","t","useTranslation","formValues","setFormValue","useState","TypeFormProduct","searchValue","setSearchValue","pageSales","setPageSales","isModalOpen","setModalOpen","auth","useAuthStore","state","isLoading","setIsLoading","useLoading","sales","setSales","useEffect","prev","handleRefreshSales","useCallback","APIFetchData","API","handleChange","event","name","value","type","checked","inputValue","handleSubmit","_a","_b","openModal","closeModal","handleSearchSales","jsx","LayoutDefault","jsxs","Link","IconChevronRight","IconRefresh","IconNew","SearchInput","IconSearch","Modal","ProductForm"],"mappings":"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"}