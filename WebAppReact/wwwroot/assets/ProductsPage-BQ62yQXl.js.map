{"version":3,"file":"ProductsPage-BQ62yQXl.js","sources":["../../front-react/src/stores/useProductsStore.jsx","../../front-react/src/pages/ProductsPage.jsx"],"sourcesContent":["import { create } from \"zustand\";\r\n\r\n// Define el store\r\nconst useProductsStore = create((set) => ({\r\n  productos: [],\r\n  setProducts: (newProducts) => set({ productos: newProducts }),\r\n}));\r\n\r\nexport default useProductsStore;\r\n","import { useTranslation } from \"react-i18next\";\r\nimport LayoutDefault from \"../layouts/LayoutDefault\";\r\nimport useProductsStore from \"../stores/useProductsStore\";\r\nimport useFetchDataStore from \"../stores/useFetchDataStore\";\r\nimport { useCallback, useEffect, useState } from \"react\";\r\nimport { API } from \"../stores/API/Endpoints\";\r\nimport { TypeFormProduct, setTypeFormProduct } from \"../types/TypesForm\";\r\nimport useAuthStore from \"../stores/useAuthStore\";\r\nimport Modal from \"../components/controls/Modal\";\r\nimport ProductForm from \"../components/forms/ProductForm\";\r\n\r\nimport { toast } from \"react-toastify\";\r\nimport SearchInput from \"../components/controls/SeachInput\";\r\n\r\nconst ProductsPage = () => {\r\n  const { t } = useTranslation();\r\n  const [formValues, setFormValue] = useState(TypeFormProduct);\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [pageProducts, setPageProducts] = useState(1);\r\n  const [sizePages, setSizePages] = useState(25);\r\n  const [isModalOpen, setModalOpen] = useState(false);\r\n\r\n  const { user } = useAuthStore((state) => ({\r\n    user: state.user,\r\n  }));\r\n\r\n  const { setProduct } = useProductsStore((state) => ({\r\n    setProduct: state.setProduct,\r\n  }));\r\n\r\n  const { callApi, data, getData, refreshData, loading, error } =\r\n    useFetchDataStore((state) => ({\r\n      callApi: state.callApi,\r\n      data: state.data,\r\n      getData: state.getData,\r\n      refreshData: state.refreshData,\r\n      loading: state.loading,\r\n      error: state.error,\r\n    }));\r\n\r\n  const products = getData(\r\n    `${API.products.url}/list?page_size=${sizePages}&page_number=${pageProducts}`\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (user?.userData?.id_usuario) {\r\n      setFormValue((prev) => ({\r\n        ...prev,\r\n        uid_creacion: user.userData.id_usuario,\r\n      }));\r\n    }\r\n  }, [user]);\r\n\r\n  const handleRefreshProducts = useCallback(() => {\r\n    refreshData(\r\n      `${API.products.url}/list?page_size=${sizePages}&page_number=${pageProducts}`\r\n    );\r\n  }, [refreshData, pageProducts, sizePages]);\r\n\r\n  useEffect(() => {\r\n    handleRefreshProducts();\r\n  }, [pageProducts, handleRefreshProducts]);\r\n\r\n  const handleChange = (event) => {\r\n    const { name, value, type, checked } = event.target;\r\n    const inputValue = type === \"checkbox\" ? (checked ? 1 : 0) : value;\r\n    setFormValue((prev) => ({\r\n      ...prev,\r\n      [name]: inputValue,\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    callApi(`${API.products.url}/save`, \"PUT\", formValues);\r\n  };\r\n\r\n  const openModal = () => setModalOpen(true);\r\n  const closeModal = () => {\r\n    setFormValue(TypeFormProduct);\r\n    setModalOpen(false);\r\n  };\r\n\r\n  const handleSearch = (event) => {\r\n    event.preventDefault();\r\n    handleRefreshProducts();\r\n  };\r\n\r\n  const handleUpdate = (event) => {\r\n    const id = event.currentTarget.value;\r\n    const edit = products.content.find(\r\n      (item) => item.id_producto === Number(id)\r\n    );\r\n    const newValue = setTypeFormProduct(edit);\r\n    setFormValue(newValue);\r\n    openModal();\r\n  };\r\n\r\n  return (\r\n    <LayoutDefault>\r\n      <div className=\"flex-1 w-full\">\r\n        <section className=\"bg-white px-4 pt-4 inline-flex justify-between items-center w-full border-b mb-4 \">\r\n          <h1 className=\"text-2xl font-semibold mb-1 pr-4\">\r\n            {t(\"products.title\")}\r\n          </h1>\r\n          <span>\r\n            <button\r\n              className=\"bg-orange-400 text-white p-1\"\r\n              value={\"refresh\"}\r\n              onClick={handleRefreshProducts}\r\n            >\r\n              {/* Icon for refresh */}\r\n              <svg\r\n                stroke=\"currentColor\"\r\n                fill=\"currentColor\"\r\n                strokeWidth=\"0\"\r\n                viewBox=\"0 0 24 24\"\r\n                height=\"16px\"\r\n                width=\"16px\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n              >\r\n                <path d=\"M5.46257 4.43262C7.21556 2.91688 9.5007 2 12 2C17.5228 2 22 6.47715 22 12C22 14.1361 21.3302 16.1158 20.1892 17.7406L17 12H20C20 7.58172 16.4183 4 12 4C9.84982 4 7.89777 4.84827 6.46023 6.22842L5.46257 4.43262ZM18.5374 19.5674C16.7844 21.0831 14.4993 22 12 22C6.47715 22 2 17.5228 2 12C2 9.86386 2.66979 7.88416 3.8108 6.25944L7 12H4C4 16.4183 7.58172 20 12 20C14.1502 20 16.1022 19.1517 17.5398 17.7716L18.5374 19.5674Z\"></path>\r\n              </svg>\r\n            </button>\r\n          </span>\r\n        </section>\r\n        <section className=\"w-full bg-white divide-y border-b pb-4 mb-2.5\">\r\n          <section className=\"w-full px-5 mx-auto flex justify-between items-center\">\r\n            <div>\r\n              <button\r\n                className={`max-w-24 w-full min-w-20 outline-green-400 px-2.5 py-1.5 text-white font-semibold relative overflow-hidden group ${\r\n                  !loading\r\n                    ? \"bg-green-600 active:scale-95 shadow\"\r\n                    : \"bg-green-600/50\"\r\n                }`}\r\n                onClick={openModal}\r\n                type=\"submit\"\r\n                disabled={loading}\r\n              >\r\n                {t(\"categories.new\")}\r\n                <div\r\n                  className={`absolute top-0 -inset-full h-full w-1/2 z-5 block transform -skew-x-12 bg-gradient-to-r from-transparent to-white opacity-40 ${\r\n                    loading\r\n                      ? \"animate-shineInfinity\"\r\n                      : \"group-hover:animate-shine\"\r\n                  } `}\r\n                />\r\n              </button>\r\n            </div>\r\n            <div className=\"inline-flex\">\r\n              <SearchInput\r\n                searchValue={searchValue}\r\n                setSearchValue={setSearchValue}\r\n              />\r\n              <button\r\n                className={`max-w-24 w-full min-w-20 outline-sky-400 px-2.5 py-1.5 text-white font-semibold relative overflow-hidden group ${\r\n                  !loading\r\n                    ? \"bg-sky-600 active:scale-95 shadow\"\r\n                    : \"bg-sky-600/50\"\r\n                }`}\r\n                onClick={handleSearch}\r\n                type=\"button\"\r\n                disabled={loading}\r\n              >\r\n                {t(\"categories.search\")}\r\n                <div\r\n                  className={`absolute top-0 -inset-full h-full w-1/2 z-5 block transform -skew-x-12 bg-gradient-to-r from-transparent to-white opacity-40 ${\r\n                    loading\r\n                      ? \"animate-shineInfinity\"\r\n                      : \"group-hover:animate-shine\"\r\n                  } `}\r\n                />\r\n              </button>\r\n            </div>\r\n          </section>\r\n        </section>\r\n        {/* Modal and forms */}\r\n        <Modal isOpen={isModalOpen} onClose={closeModal}>\r\n          <ProductForm\r\n            loading={loading}\r\n            formValues={formValues}\r\n            setFormValue={setFormValue}\r\n            handleChange={handleChange}\r\n            handleSubmit={handleSubmit}\r\n          />\r\n        </Modal>\r\n      </div>\r\n    </LayoutDefault>\r\n  );\r\n};\r\n\r\nexport default ProductsPage;\r\n"],"names":["useProductsStore","create","set","newProducts","ProductsPage","t","useTranslation","formValues","setFormValue","useState","TypeFormProduct","searchValue","setSearchValue","pageProducts","setPageProducts","sizePages","setSizePages","isModalOpen","setModalOpen","user","useAuthStore","state","callApi","data","getData","refreshData","loading","error","useFetchDataStore","API","useEffect","_a","prev","handleRefreshProducts","useCallback","handleChange","event","name","value","type","checked","inputValue","handleSubmit","openModal","closeModal","handleSearch","jsx","LayoutDefault","jsxs","SearchInput","Modal","ProductForm"],"mappings":"4QAGA,MAAMA,EAAmBC,EAAQC,IAAS,CACxC,UAAW,CAAC,EACZ,YAAcC,GAAgBD,EAAI,CAAE,UAAWC,EAAa,CAC9D,EAAE,ECQIC,EAAe,IAAM,CACnB,KAAA,CAAE,EAAAC,GAAMC,IACR,CAACC,EAAYC,CAAY,EAAIC,WAASC,CAAe,EACrD,CAACC,EAAaC,CAAc,EAAIH,WAAS,EAAE,EAC3C,CAACI,EAAcC,CAAe,EAAIL,WAAS,CAAC,EAC5C,CAACM,EAAWC,CAAY,EAAIP,WAAS,EAAE,EACvC,CAACQ,EAAaC,CAAY,EAAIT,WAAS,EAAK,EAE5C,CAAE,KAAAU,CAAA,EAASC,EAAcC,IAAW,CACxC,KAAMA,EAAM,IACZ,EAAA,EAEqBrB,EAAkBqB,IAAW,CAClD,WAAYA,EAAM,UAAA,EAClB,EAEI,KAAA,CAAE,QAAAC,EAAS,KAAAC,EAAM,QAAAC,EAAS,YAAAC,EAAa,QAAAC,EAAS,MAAAC,CAAM,EAC1DC,EAAmBP,IAAW,CAC5B,QAASA,EAAM,QACf,KAAMA,EAAM,KACZ,QAASA,EAAM,QACf,YAAaA,EAAM,YACnB,QAASA,EAAM,QACf,MAAOA,EAAM,KACb,EAAA,EAEaG,EACf,GAAGK,EAAI,SAAS,GAAG,mBAAmBd,CAAS,gBAAgBF,CAAY,EAC7E,EAEAiB,EAAAA,UAAU,IAAM,QACVC,EAAAZ,GAAA,YAAAA,EAAM,WAAN,MAAAY,EAAgB,YAClBvB,EAAcwB,IAAU,CACtB,GAAGA,EACH,aAAcb,EAAK,SAAS,UAC5B,EAAA,CACJ,EACC,CAACA,CAAI,CAAC,EAEH,MAAAc,EAAwBC,EAAAA,YAAY,IAAM,CAC9CT,EACE,GAAGI,EAAI,SAAS,GAAG,mBAAmBd,CAAS,gBAAgBF,CAAY,EAAA,CAE5E,EAAA,CAACY,EAAaZ,EAAcE,CAAS,CAAC,EAEzCe,EAAAA,UAAU,IAAM,CACQG,GAAA,EACrB,CAACpB,EAAcoB,CAAqB,CAAC,EAElC,MAAAE,EAAgBC,GAAU,CAC9B,KAAM,CAAE,KAAAC,EAAM,MAAAC,EAAO,KAAAC,EAAM,QAAAC,GAAYJ,EAAM,OACvCK,EAAaF,IAAS,WAAcC,EAAU,EAAI,EAAKF,EAC7D9B,EAAcwB,IAAU,CACtB,GAAGA,EACH,CAACK,CAAI,EAAGI,CACR,EAAA,CAAA,EAGEC,EAAgBN,GAAU,CAC9BA,EAAM,eAAe,EACrBd,EAAQ,GAAGO,EAAI,SAAS,GAAG,QAAS,MAAOtB,CAAU,CAAA,EAGjDoC,EAAY,IAAMzB,EAAa,EAAI,EACnC0B,EAAa,IAAM,CACvBpC,EAAaE,CAAe,EAC5BQ,EAAa,EAAK,CAAA,EAGd2B,EAAgBT,GAAU,CAC9BA,EAAM,eAAe,EACCH,GAAA,EAaxB,OACGa,EAAA,IAAAC,EAAA,CACC,SAACC,EAAAA,KAAA,MAAA,CAAI,UAAU,gBACb,SAAA,CAACA,EAAAA,KAAA,UAAA,CAAQ,UAAU,oFACjB,SAAA,CAAAF,MAAC,KAAG,CAAA,UAAU,mCACX,SAAAzC,EAAE,gBAAgB,EACrB,QACC,OACC,CAAA,SAAAyC,EAAA,IAAC,SAAA,CACC,UAAU,+BACV,MAAO,UACP,QAASb,EAGT,SAAAa,EAAA,IAAC,MAAA,CACC,OAAO,eACP,KAAK,eACL,YAAY,IACZ,QAAQ,YACR,OAAO,OACP,MAAM,OACN,MAAM,6BAEN,SAAAA,EAAAA,IAAC,OAAK,CAAA,EAAE,saAAua,CAAA,CAAA,CACjb,CAAA,CAAA,EAEJ,CAAA,EACF,QACC,UAAQ,CAAA,UAAU,gDACjB,SAACE,EAAA,KAAA,UAAA,CAAQ,UAAU,wDACjB,SAAA,CAAAF,MAAC,MACC,CAAA,SAAAE,EAAA,KAAC,SAAA,CACC,UAAW,oHACRtB,EAEG,kBADA,qCAEN,GACA,QAASiB,EACT,KAAK,SACL,SAAUjB,EAET,SAAA,CAAArB,EAAE,gBAAgB,EACnByC,EAAA,IAAC,MAAA,CACC,UAAW,gIACTpB,EACI,wBACA,2BACN,GAAA,CACF,CAAA,CAAA,CAAA,EAEJ,EACAsB,EAAAA,KAAC,MAAI,CAAA,UAAU,cACb,SAAA,CAAAF,EAAA,IAACG,EAAA,CACC,YAAAtC,EACA,eAAAC,CAAA,CACF,EACAoC,EAAA,KAAC,SAAA,CACC,UAAW,kHACRtB,EAEG,gBADA,mCAEN,GACA,QAASmB,EACT,KAAK,SACL,SAAUnB,EAET,SAAA,CAAArB,EAAE,mBAAmB,EACtByC,EAAA,IAAC,MAAA,CACC,UAAW,gIACTpB,EACI,wBACA,2BACN,GAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,CAAA,CAAA,CACF,CACF,CAAA,EAECoB,EAAA,IAAAI,EAAA,CAAM,OAAQjC,EAAa,QAAS2B,EACnC,SAAAE,EAAA,IAACK,EAAA,CACC,QAAAzB,EACA,WAAAnB,EACA,aAAAC,EACA,aAAA2B,EACA,aAAAO,CAAA,CAAA,EAEJ,CAAA,CACF,CAAA,CACF,CAAA,CAEJ"}